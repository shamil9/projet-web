{% extends 'base.html.twig' %}
{% block title %}{{ user.name }}{% endblock %}
{% block stylesheets %}<link rel="stylesheet" href="{{ asset('assets/css/bootstrap-stars.css') }}">
{% endblock %}
{% block body %}
<div class="container">
    <div class="row">
        <div class="col-lg-12 pro-slider">
            <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
                <!-- Indicators -->
                <ol class="carousel-indicators">
                    <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
                    <li data-target="#carousel-example-generic" data-slide-to="1"></li>
                </ol>

                <!-- Wrapper for slides -->
                <div class="carousel-inner" role="listbox">
                    <div class="item active">
                        <img src="{{ asset('assets/img/slider/1.jpg') }}"
                             alt="">
                        <div class="carousel-caption">
                            <h1>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Repellat, voluptate.</h1>
                        </div>
                    </div>
                    <div class="item">
                        <img src="{{ asset('assets/img/slider/2.jpg') }}"
                             alt="">
                        <div class="carousel-caption">
                            <h1>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Iure, unde!</h1>
                        </div>
                    </div>

                    <!-- Controls -->
                    <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
                        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
                        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>
            <div class="pro_userbar col-lg-12">
                <div class="pro_avatar pull-left">
                    <img src="{{ asset('assets/img/uploads/avatars/user.svg') }}" alt="Avatar" class="pro_avatar img--100x100 thumbnail">
                </div>
                <span class="pro_user-info">{{ user.name }} </span>

                {#Button de favoris#}
                {% if user is member %}
                    {% if favorite %}
                        <a href="" class="glyphicon glyphicon-bookmark favorite favorite__active"
                                id="remove-favorite"
                                title="Supprimer le favori">
                            {#<span class="glyphicon glyphicon-remove"></span>#}
                        </a>
                    {% else %}
                        <a href="" class="glyphicon glyphicon-bookmark favorite"
                                id="add-favorite"
                                title="Ajouter aux favoris">
                            {#<span class="glyphicon glyphicon-bookmark"></span>#}
                        </a>
                    {% endif %}
                {% endif %}

                {#Social media#}
                <span class="pull-right">
                    <a href="#"><img class="pro_social-icons" src="{{ asset('assets/img/icons/twitter.svg') }}" alt=""></a>
                    <a href="#"><img class="pro_social-icons" src="{{ asset('assets/img/icons/facebook.svg') }}" alt=""></a>
                    <a href="#" data-toggle="modal" data-target="#recommend-user-form">
                        <img class="pro_social-icons" src="{{ asset('assets/img/icons/mail.svg') }}" alt="">
                    </a>
                    {% include'pro_member/partials/_recommend-form.html.twig' %}
                </span>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12">
            <div class="pro-tabs">
                <div>
                    <!-- Nav tabs -->
                    <ul class="nav nav-tabs" role="tablist">

                        <li role="presentation" class="active">
                            <a href="#categories" aria-controls="categories" role="tab" data-toggle="tab">Cat√©gories</a>
                        </li>

                        {#Stages#}
                        {% if user.workshops is not empty %}
                        <li role="presentation">
                            <a href="#stages" aria-controls="stages" role="tab" data-toggle="tab">
                                Stages
                                <span class="badge">{{ user.workshops|length }}</span>
                            </a>
                        </li>
                        {% endif %}

                        {#Promotions#}
                        {% if user.sales is not empty %}
                        <li role="presentation">
                            <a href="#promotions" aria-controls="promotions" role="tab" data-toggle="tab">
                                Promotions
                                <span class="badge">{{ user.sales|length }}</span>
                            </a>
                        </li>
                        {% endif %}

                        {#Commentaire#}
                        <li role="presentation">
                            <a href="#commentaires" aria-controls="commentaires" role="tab" data-toggle="tab">
                                Commentaires
                                <span class="badge">{{ user.comments|length }}</span>
                            </a>
                        </li>

                        {#La carte#}
                        <li role="presentation">
                            <a href="#localisation" aria-controls="localisation" role="tab" data-toggle="tab">Localisation</a>
                        </li>
                    </ul>

                    <!-- Tab panes -->
                    <div class="tab-content">
                        <div role="tabpanel" class="tab-pane active" id="categories">
                            {% include 'pro_member/partials/_categories.html.twig' %}
                        </div>

                        {% if user.workshops is not empty  %}
                        <div role="tabpanel" class="tab-pane" id="stages">
                            <h1>Stages</h1>
                            {% include 'pro_member/partials/_workshops.html.twig' %}
                        </div>
                        {% endif %}

                        {% if user.sales is not empty %}
                        <div role="tabpanel" class="tab-pane" id="promotions">
                            <h1>Promotions</h1>
                            {% include 'pro_member/partials/_sales.html.twig' %}
                        </div>
                        {% endif %}

                        <div role="tabpanel" class="tab-pane" id="commentaires">
                            <h1>Commentaires</h1>
                            {% include'pro_member/partials/_comments.html.twig' %}
                        </div>

                        <div role="tabpanel" class="tab-pane" id="localisation">
                            <h1>Localisation</h1>
                            <div id="map" class="col-lg-6 map"></div>
                        </div>
                    </div>
                </div>
            </div> <!-- tabs end -->

            <hr>
            <div class="row">
                <div class="col-lg-12">
                    <h3>Prestataires similaires</h3>
                    <div id="suggestions">
                        <img class="center-block" src="{{ asset('assets/img/icons/infinity.gif') }}" width="100px" alt="">
                    </div>
                </div>
            </div> <!-- suggestion end -->

        </div>
    </div>
</div>
{% endblock %}
{% block javascripts %}
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBt6NP5o5G-VPddw-tdyZ7I-N41_l04Sic"></script>
    <script src="{{ asset('assets/js/gmaps.js') }}"></script>
    <script src="{{ asset('assets/js/jquery.barrating.min.js') }}"></script>
    <script src="{{ asset('assets/js/app.js') }}"></script>
    <script>
        {% if user %}
        $('#add-favorite').on('click', function (e) {
            e.preventDefault();
            addFavorite('{{ path('members_add_favorite', {'proMember': user.id}) }}', this);
        });

        $('#remove-favorite').on('click', function (e) {
            e.preventDefault();
            removeFavorite('{{ path('members_remove_favorite', {'proMember': user.id}) }}', this);
        });

        $('#comments').on('submit', function (e) {
            e.preventDefault();

            postcomment({
                url: '{{ path('pro_member_comments_new', {'slug': user.slug}) }}',
                user: '{{ user.username }}',
                picture: '{{ user.picture }}',
                self: this
            });
        });
        {% endif %}

        $('#comment_rating').barrating({
            theme: 'bootstrap-stars'
        });

        showGoogleMap('{{ user.street }}, {{ user.city }}');

        getSuggestions('{{ path('pro_member_suggestions', {'user': user.id}) }}');
    </script>
{% endblock %}
